!!! 5

%html
  %head
    %title Criminal Case Search
    = bootstrap_assets
    :css
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .datashare-filter {
        padding: 9px;
      }
    :javascript
      $(function(){
        $('.more-or-less').each(function(i, el) {
        console.log(el);
          $(el).find("li a").click(function() {
          $(el).find("button").html($(this).text() + ' <span class="caret"></span>');
          $(el).find("input.more-or-less-type").val($(this).text()); 
          });
        });

        $(".btn-group.buttons-radio").each(function(i, el) {
          $(el).find("button").click(function() {
            var hidden_field = $(el).find('input[type="hidden"]')
            hidden_field.val($(this).text());
          })
        })
      })

  %body
    .navbar.navbar-inverse.navbar-fixed-top
      .navbar-inner
        .container-fluid
          %button.btn.btn-navbar{ type: "button", "data-toggle" => "collapse", "data-target" => ".nav-collapse"}
            %span.icon-bar
            %span.icon-bar
            %span.icon-bar
          %a.brand{ href: "#"}
            Criminal Case Search
          .nav-collapse.collapse
            %p.navbar-text.pull-right
              Logged in as <a href="#" class="navbar-link">Username</a>
            %ul.nav
              %li.active
                %a{ href: "/"}
                  Home

    - container :fluid do
      .row-fluid
        %span.span4
          .well.datashare-filter
            %form{action: "/"}
              %fieldset
                %legend Filter Options
                %select.input-xlarge{name: "filter[borough]", }
                  %option{value: "A", selected: params[:filter][:borough] == "A"} All Boroughs
                  %option{value: "B", selected: params[:filter][:borough] == "B"} Bronx
                  %option{value: "K", selected: params[:filter][:borough] == "K"} Brooklyn
                  %option{value: "M", selected: params[:filter][:borough] == "M"} Manhattan
                  %option{value: "Q", selected: params[:filter][:borough] == "Q"} Queens
                  %option{value: "S", selected: params[:filter][:borough] == "S"} Staten Island
                -#%input.input-xlarge{ type: "text", placeholder: "Arrest ID"}
                -#%span.help-block help text
              %fieldset.inline
                %label Top Charge
                .btn-group.buttons-radio.topcharge{data: {toggle: "buttons-radio"}}
                  %button.btn{type: "button", class: params[:filter][:topcharge] == nil || params[:filter][:topcharge] == "Any" ? "active" : ""  } Any
                  %button.btn{type: "button", class: params[:filter][:topcharge] == "Non-Criminal" ? "active" : ""  } Non-Criminal
                  %button.btn{type: "button", class: params[:filter][:topcharge] == "Misdemeanor" ? "active" : "" } Misdemeanor
                  %button.btn{type: "button", class: params[:filter][:topcharge] == "Felony" ? "active" : "" } Felony
                  %input.topcharge{type: "hidden", name: "filter[topcharge]", value: params[:filter][:topcharge] || "Any" }

              %fieldset
                %label Age
                %input.inline.input-mini{name: "filter[min_age]", type: "text", placeholder: "Min Age", value: params[:filter][:min_age] }
                &ndash;
                %input.inline.input-mini{name: "filter[max_age]", type: "text", placeholder: "Max Age", value: params[:filter][:max_age] }

              %fieldset
                %label Sex
                .btn-group.buttons-radio.sex{data: {toggle: "buttons-radio"}}
                  %button.btn{type: "button", class: params[:filter][:sex] == nil || params[:filter][:sex] == "All" ? "active" : ""  } All
                  %button.btn{type: "button", class: params[:filter][:sex] == "Male" ? "active" : "" } Male
                  %button.btn{type: "button", class: params[:filter][:sex] == "Female" ? "active" : "" } Female
                  %input.sex{type: "hidden", name: "filter[sex]", value: params[:filter][:sex] || "All" }

              %fieldset
                %label Previous Violent Felony Convictions
                .input-append.more-or-less
                  %input.input-mini{name: "filter[previous_violent_felony_convictions_number]", type: "text", value: params[:filter][:previous_violent_felony_convictions_number] }
                  .btn-group.previous-convictions
                    %button.btn.dropdown-toggle{"data-toggle" => "dropdown" }
                      = params[:filter][:previous_violent_felony_convictions_type] || "or more"
                      %span.caret
                    %ul.dropdown-menu
                      %li
                        %a or more
                      %li
                        %a or less
                    %input.more-or-less-type{name: "filter[previous_violent_felony_convictions_type]", type: "hidden", value: params[:filter][:previous_violent_felony_convictions_type] || "or more" }

                %label Previous Felony Convictions
                .input-append.more-or-less
                  %input.input-mini{name: "filter[previous_felony_convictions_number]", type: "text", value: params[:filter][:previous_felony_convictions_number] }
                  .btn-group.previous-convictions
                    %button.btn.dropdown-toggle{"data-toggle" => "dropdown" }
                      = params[:filter][:previous_felony_convictions_type] || "or more"
                      %span.caret
                    %ul.dropdown-menu
                      %li
                        %a or more
                      %li
                        %a or less
                    %input.more-or-less-type{name: "filter[previous_felony_convictions_type]", type: "hidden", value: params[:filter][:previous_felony_convictions_type] || "or more" }



                %label Previous Misdemeanor Convictions
                .input-append.more-or-less
                  %input.input-mini{name: "filter[previous_misdemeanor_convictions_number]", type: "text", value: params[:filter][:previous_misdemeanor_convictions_number] }
                  .btn-group.previous-convictions
                    %button.btn.dropdown-toggle{"data-toggle" => "dropdown" }
                      = params[:filter][:previous_misdemeanor_convictions_type] || "or more"
                      %span.caret
                    %ul.dropdown-menu
                      %li
                        %a or more
                      %li
                        %a or less
                    %input.more-or-less-type{name: "filter[previous_misdemeanor_convictions_type]", type: "hidden", value: params[:filter][:previous_misdemeanor_convictions_type] || "or more" }

              .form-actions
                %button.btn.btn-primary{ type: "submit"} Filter
                %a.btn{href: "/"} Reset

        .span8
          = yield
